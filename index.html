<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yusuf Yaman - Dijital Satış Asistanı</title>
    <meta name="description" content="Yusuf Yaman'ın Dijital Satış ve Organik Büyüme Asistanı - Instagram, TikTok ve dijital ürün satışı konularında yardımcı olur.">
    <link rel="icon" href="https://raw.githubusercontent.com/huzaifi0604/Favicon/main/favicon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #f7f7f8;
            --bg-secondary: #ffffff;
            --bg-sidebar: #202123;
            --text-primary: #1a1a1a;
            --text-secondary: #6e6e80;
            --text-on-primary: #ffffff;
            --border-color: #e5e5e6;
            --accent-color: #10a37f;
            --accent-hover: #0e8e6d;
            --sidebar-text: #ffffff;
            --user-message-bg: #10a37f;
            --user-message-text: #ffffff;
            --bot-message-bg: #ffffff;
            --bot-message-text: #1a1a1a;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1e1e2e;
            --bg-secondary: #2a2b32;
            --bg-sidebar: #0f0f17;
            --text-primary: #f1f1f3;
            --text-secondary: #acacbe;
            --text-on-primary: #f1f1f3;
            --border-color: #4d4d4f;
            --accent-color: #10a37f;
            --accent-hover: #0e8e6d;
            --sidebar-text: #ffffff;
            --user-message-bg: #10a37f;
            --user-message-text: #ffffff;
            --bot-message-bg: #2a2b32;
            --bot-message-text: #f1f1f3;
            --shadow-color: rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            margin: 0;
            transition: background-color 0.3s, color 0.3s;
        }

        .app-container {
            display: flex;
            height: 100vh;
            max-width: 100%;
            margin: 0 auto;
        }

        .sidebar {
            width: 260px;
            background-color: var(--bg-sidebar);
            color: var(--sidebar-text);
            padding: 16px;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s;
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .logo img {
            width: 30px;
            height: 30px;
            margin-right: 10px;
            border-radius: 50%;
        }

        .logo h1 {
            font-size: 16px;
            font-weight: 600;
        }

        .new-chat-btn {
            background-color: var(--accent-color);
            color: var(--text-on-primary);
            border: none;
            border-radius: 5px;
            padding: 12px;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .new-chat-btn:hover {
            background-color: var(--accent-hover);
        }

        .theme-switch-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .theme-text {
            font-size: 14px;
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 22px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: var(--accent-color);
        }

        input:checked + .slider:before {
            transform: translateX(22px);
        }

        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .history {
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .history-item {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s;
        }

        .history-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .history-item.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .user-info {
            display: flex;
            align-items: center;
            padding: 10px;
            border-top: 1px solid var(--border-color);
            margin-top: auto;
        }

        .user-info img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-primary);
            transition: background-color 0.3s;
        }

        .chat-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s, border-color 0.3s;
        }

        .chat-header h2 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        #clearChatBtn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 16px;
            transition: color 0.2s;
        }

        #clearChatBtn:hover {
            color: var(--accent-color);
        }

        .chat-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            background-color: var(--bg-primary);
            transition: background-color 0.3s;
        }

        .message {
            display: flex;
            max-width: 85%;
            animation: fadeIn 0.3s ease;
        }

        .bot-message {
            align-self: flex-start;
        }

        .user-message {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            margin: 0 8px;
            flex-shrink: 0;
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-message .avatar {
            display: none;
        }

        .message-content {
            padding: 15px;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.5;
            box-shadow: 0 1px 2px var(--shadow-color);
            transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
        }

        .bot-message .message-content {
            background-color: var(--bot-message-bg);
            color: var(--bot-message-text);
            border-top-left-radius: 0;
        }

        .user-message .message-content {
            background-color: var(--user-message-bg);
            color: var(--user-message-text);
            border-top-right-radius: 0;
        }

        .message-content p {
            margin-bottom: 10px;
        }

        .message-content p:last-child {
            margin-bottom: 0;
        }

        .message-content ul, .message-content ol {
            margin-left: 20px;
            margin-top: 5px;
            margin-bottom: 10px;
        }

        .message-content li {
            margin-bottom: 8px;
        }
        
        .message-content h3 {
            margin-top: 15px;
            margin-bottom: 10px;
            color: var(--accent-color);
        }
        
        .message-content strong {
            color: var(--accent-color);
        }

        .input-container {
            padding: 16px;
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            align-items: flex-end;
            transition: background-color 0.3s, border-color 0.3s;
        }

        #userInput {
            flex-grow: 1;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px 15px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            resize: none;
            outline: none;
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            max-height: 150px;
            overflow-y: auto;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        #userInput:focus {
            border-color: var(--accent-color);
        }

        #userInput::placeholder {
            color: var(--text-secondary);
        }

        #sendButton {
            background-color: var(--accent-color);
            color: var(--text-on-primary);
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }

        #sendButton:hover {
            background-color: var(--accent-hover);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-secondary);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color);
        }

        .topic-section {
            margin-top: 10px;
            margin-bottom: 5px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                max-height: 30vh;
                overflow-y: auto;
            }
            
            .main-content {
                height: 70vh;
            }
            
            .message {
                max-width: 90%;
            }
            
            .chat-container {
                padding: 10px;
                gap: 16px;
            }
            
            .message-content {
                padding: 12px;
                font-size: 14px;
            }
            
            .message-content ul, .message-content ol {
                margin-left: 16px;
            }
            
            .input-container {
                padding: 12px;
            }
            
            #userInput {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sol Menü -->
        <div class="sidebar">
            <div class="logo">
                <img src="https://raw.githubusercontent.com/huzaifi0604/Favicon/main/favicon.png" alt="Logo">
                <h1>Dijital Satış Asistanı</h1>
            </div>
            
            <button class="new-chat-btn" id="newChatBtn">
                <span>+ Yeni Sohbet</span>
            </button>
            
            <div class="theme-switch-container">
                <span class="theme-text">Karanlık Mod</span>
                <label class="theme-switch">
                    <input type="checkbox" id="themeSwitch">
                    <span class="slider round"></span>
                </label>
            </div>
            
            <div class="history" id="historyContainer">
                <div class="history-item active" data-topic="welcome">
                    <span>Hoş Geldiniz</span>
                </div>
                <div class="history-item" data-topic="instagram">
                    <span>Instagram Rehberi</span>
                </div>
                <div class="history-item" data-topic="tiktok">
                    <span>TikTok Stratejileri</span>
                </div>
                <div class="history-item" data-topic="dijitalurun">
                    <span>Dijital Ürün Oluşturma</span>
                </div>
                <div class="history-item" data-topic="yapayzekaicin">
                    <span>Yapay Zeka Araçları</span>
                </div>
                <div class="history-item" data-topic="niskonulari">
                    <span>Niş Seçimi</span>
                </div>
                <div class="history-item" data-topic="monetizasyon">
                    <span>Monetizasyon Yöntemleri</span>
                </div>
                <div class="history-item" data-topic="contentplan">
                    <span>İçerik Planı Oluşturma</span>
                </div>
            </div>
            
            <div class="user-info">
                <img src="https://raw.githubusercontent.com/huzaifi0604/Favicon/main/favicon.png" alt="User">
                <span>Yusuf Yaman</span>
            </div>
        </div>

        <!-- Ana İçerik -->
        <div class="main-content">
            <!-- Sohbet Başlığı -->
            <div class="chat-header">
                <h2>Dijital Satış Asistanı</h2>
                <button id="clearChatBtn" title="Sohbeti Temizle">
                    <span>🗑️</span>
                </button>
            </div>

            <!-- Sohbet Alanı -->
            <div class="chat-container" id="chatContainer">
                <!-- Bot Karşılama Mesajı otomatik olarak eklenecek -->
            </div>

            <!-- Mesaj Gönderme Alanı -->
            <div class="input-container">
                <textarea id="userInput" placeholder="Mesajınızı buraya yazın..." rows="1"></textarea>
                <button id="sendButton">
                    <span>➤</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elementleri
            const chatContainer = document.getElementById('chatContainer');
            const userInput = document.getElementById('userInput');
            const sendButton = document.getElementById('sendButton');
            const newChatBtn = document.getElementById('newChatBtn');
            const historyItems = document.querySelectorAll('.history-item');
            const clearChatBtn = document.getElementById('clearChatBtn');
            const themeSwitch = document.getElementById('themeSwitch');
            
            // Gemini API konfigürasyonu
            const API_KEY = 'AIzaSyAhdRR0uKZvCGGV90NIfgu0TIUdsqFWKt4';
            const MODEL = 'gemini-2.0-flash';
            
            // Sistem talimatları
            const systemInstructions = `
Sen Yusuf Yaman'ın resmi Dijital Satış ve Organik Büyüme eğitim asistanısın. Aşağıdaki konularda uzman bir eğitmensin:

- Sosyal Medya Platformları (Instagram ve TikTok)
- Organik Büyüme Stratejileri (algoritma, keşfet, hashtag, CTA)
- Dijital Satış Temelleri (dijital ürünler, satış süreçleri)
- Niş Seçimi ve İçerik Üretimi (motivasyon, ilişki, finans nişleri)
- Yapay Zeka Kullanımı (ChatGPT, Grok, ElevenLabs, Midjourney, Canva)
- Türkiye'de Dijital Satış Başlangıç Rehberi

Yanıtların her zaman:
- Ciddi, rehber ve motive edici tonda olmalı
- Adım adım, net ve yapılandırılmış olmalı
- Sabırlı ve teşvik edici olmalı
- Kullanıcıya "öğrenci" gibi davranmalısın

HTML formatında yanıt ver, kullanabileceğin HTML etiketleri: <p>, <h3>, <ul>, <ol>, <li>, <strong>, <em>, <blockquote>

Yanıtlarında şu gerçekler her zaman doğrudur:
1. Dijital ürünler yüksek kâr marjına sahiptir
2. Organik büyüme stratejileri ücretli reklamlardan daha sürdürülebilirdir
3. Yusuf Yaman dijital satış konusunda uzman bir eğitmendir
4. Türkiye'de dijital ürün satışı yapmak için özel stratejiler gereklidir

Eğer sana eğitimin içeriği dışında bir soru sorulursa: "Bu konu Yusuf Yaman'ın Dijital Satış eğitiminin dışında kalıyor. Algoritma, içerik üretimi veya dijital ürün satışı hakkında bir soru sormak ister misin?" diye yanıtla.
`;

            // Chat geçmişi hafızası (Gemini'nin bağlamı tutması için)
            let chatHistory = [];

            // Tema ve Sohbet Geçmişi Yönetimi
            initTheme();
            loadChatHistory();

            // Tema Değiştirme
            function initTheme() {
                const savedTheme = localStorage.getItem('yusufYamanTheme');
                if (savedTheme === 'dark') {
                    document.body.setAttribute('data-theme', 'dark');
                    themeSwitch.checked = true;
                }
            }

            themeSwitch.addEventListener('change', function() {
                if (this.checked) {
                    document.body.setAttribute('data-theme', 'dark');
                    localStorage.setItem('yusufYamanTheme', 'dark');
                } else {
                    document.body.removeAttribute('data-theme');
                    localStorage.setItem('yusufYamanTheme', 'light');
                }
            });

            // Sohbet Geçmişini Kaydetme ve Yükleme
            function saveChatHistory() {
                localStorage.setItem('yusufYamanChatHistory', chatContainer.innerHTML);
                // Ayrıca sohbet bağlamını da kaydedelim (Gemini için)
                localStorage.setItem('yusufYamanChatContext', JSON.stringify(chatHistory));
            }

            function loadChatHistory() {
                const savedChat = localStorage.getItem('yusufYamanChatHistory');
                const savedContext = localStorage.getItem('yusufYamanChatContext');
                
                if (savedChat && savedChat.trim() !== '') {
                    chatContainer.innerHTML = savedChat;
                } else {
                    showWelcomeMessage();
                }
                
                if (savedContext) {
                    try {
                        chatHistory = JSON.parse(savedContext);
                    } catch (e) {
                        console.error('Chat context parsing error:', e);
                        chatHistory = [];
                    }
                }
                
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Sohbeti Temizleme
            clearChatBtn.addEventListener('click', function() {
                if (confirm('Sohbet geçmişini temizlemek istediğinize emin misiniz?')) {
                    chatContainer.innerHTML = '';
                    chatHistory = []; // Gemini bağlamını da temizle
                    localStorage.removeItem('yusufYamanChatHistory');
                    localStorage.removeItem('yusufYamanChatContext');
                    showWelcomeMessage();
                }
            });

            // Hoş Geldin Mesajı
            function showWelcomeMessage() {
                const welcomeMessage = `
                    <div class="message bot-message">
                        <div class="avatar">
                            <img src="https://raw.githubusercontent.com/huzaifi0604/Favicon/main/favicon.png" alt="Bot Avatar">
                        </div>
                        <div class="message-content">
                            <p>Merhaba, ben Yusuf Yaman'ın Dijital Satış Asistanıyım! Size nasıl yardımcı olabilirim?</p>
                            <p>Aşağıdaki konularda uzmanlaşmış durumdayım:</p>
                            <ul>
                                <li><strong>Instagram ve TikTok Stratejileri:</strong> Algoritma, keşfete çıkma, içerik planlaması</li>
                                <li><strong>Dijital Ürün Oluşturma:</strong> E-book, çevrimiçi kurslar, dijital şablonlar</li>
                                <li><strong>Yapay Zeka ile İçerik Üretimi:</strong> ChatGPT, Midjourney, ElevenLabs kullanım rehberleri</li>
                                <li><strong>Niş Seçimi ve Pazar Araştırması:</strong> Kârlı dijital ürün nişleri bulma</li>
                                <li><strong>Monetizasyon Stratejileri:</strong> Dijital ürünlerden para kazanma yöntemleri</li>
                                <li><strong>İçerik Planı Oluşturma:</strong> 30-90 günlük içerik takvimi hazırlama</li>
                            </ul>
                            <p>Sorularınızı sormaya başlayabilir veya soldaki menüden bir konu seçebilirsiniz!</p>
                        </div>
                    </div>
                `;
                chatContainer.innerHTML = welcomeMessage;
                // Bot'un mesajını chat geçmişine ekleyelim
                chatHistory.push({
                    role: "model",
                    parts: [{ text: "Merhaba, ben Yusuf Yaman'ın Dijital Satış Asistanıyım! Size nasıl yardımcı olabilirim? Aşağıdaki konularda uzmanlaşmış durumdayım: Instagram ve TikTok Stratejileri, Dijital Ürün Oluşturma, Yapay Zeka ile İçerik Üretimi, Niş Seçimi ve Pazar Araştırması, Monetizasyon Stratejileri, İçerik Planı Oluşturma. Sorularınızı sormaya başlayabilir veya soldaki menüden bir konu seçebilirsiniz!" }]
                });
                saveChatHistory();
            }

            // Mesaj Gönderme İşlevi
            function sendMessage() {
                const message = userInput.value.trim();
                if (message === '') return;

                // Kullanıcı mesajını ekle
                addMessage('user', `<p>${message}</p>`);
                
                // Kullanıcı mesajını sohbet geçmişine ekle
                chatHistory.push({
                    role: "user",
                    parts: [{ text: message }]
                });
                
                // Giriş alanını temizle
                userInput.value = '';
                userInput.style.height = 'auto';
                
                // Botun cevap vermesini sağla
                generateBotResponse(message);
            }

            // Kullanıcı veya Bot Mesajı Ekleme
            function addMessage(type, content) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}-message`;
                
                let html = '';
                
                if (type === 'bot') {
                    html += `
                        <div class="avatar">
                            <img src="https://raw.githubusercontent.com/huzaifi0604/Favicon/main/favicon.png" alt="Bot Avatar">
                        </div>
                    `;
                }
                
                html += `<div class="message-content">${content}</div>`;
                
                messageDiv.innerHTML = html;
                chatContainer.appendChild(messageDiv);
                
                // Sohbeti en aşağı kaydır
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                // Sohbet geçmişini kaydet
                saveChatHistory();
                
                return messageDiv;
            }
            
            // Google Gemini API ile Bot Yanıtı Oluşturma
            async function generateBotResponse(userMessage) {
                // Yükleniyor mesajı ekle
                const loadingMessage = addMessage('bot', '<p><em>Yanıt yazılıyor...</em></p>');
                
                try {
                    // API isteği için gerekli URL ve veriler
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`;
                    
                    // Sistem talimatlarıyla kullanıcı mesajını birleştir
                    const promptWithSystem = systemInstructions + "\n\nŞimdi, kullanıcının şu sorusuna yanıt ver: " + userMessage;
                    
                    // API isteğinde kullanılacak veri
                    const requestData = {
                        contents: [
                            {
                                role: "user",
                                parts: [{ text: promptWithSystem }]
                            },
                            ...chatHistory.slice(-6) // Son birkaç mesajı bağlam olarak ekleyelim
                        ],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 2048,
                            topP: 0.95,
                            topK: 50
                        },
                        safetySettings: [
                            {
                                category: "HARM_CATEGORY_HARASSMENT",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            },
                            {
                                category: "HARM_CATEGORY_HATE_SPEECH",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            },
                            {
                                category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            },
                            {
                                category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                                threshold: "BLOCK_MEDIUM_AND_ABOVE"
                            }
                        ]
                    };
                    
                    // CORS sorunu çözümü için proxy kullanımı
                    // Not: Bu bir workaround, ideal olarak kendi backend'inizi kullanmalısınız
                    const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                    const finalUrl = apiUrl;
                    
                    // API'ye istek gönder
                    const response = await fetch(finalUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestData)
                    });
                    
                    // API yanıtını al
                    const data = await response.json();
                    
                    // Yükleniyor mesajını kaldır
                    chatContainer.removeChild(loadingMessage);
                    
                    // API yanıtını kontrol et ve ekle
                    if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0].text) {
                        const aiResponse = data.candidates[0].content.parts[0].text;
                        
                        // Yanıtı sohbet geçmişine ekle
                        chatHistory.push({
                            role: "model",
                            parts: [{ text: aiResponse }]
                        });
                        
                        // Yanıtı ekrana ekle
                        addMessage('bot', aiResponse);
                    } else {
                        // Fallback: Eğer API yanıt vermezse yedek yanıt
                        const fallbackResponse = `
                            <p>Özür dilerim, şu anda bir teknik sorun yaşıyorum ve Gemini API'ye bağlanamıyorum. Size şu konularda yardımcı olabilirim:</p>
                            <ul>
                                <li><strong>Instagram ve TikTok büyüme stratejileri</strong> hakkında sorular sorabilirsiniz</li>
                                <li><strong>Dijital ürün oluşturma ve satış</strong> konusunda bilgi alabilirsiniz</li>
                                <li><strong>Yapay zeka ile içerik üretimi</strong> hakkında ipuçları isteyebilirsiniz</li>
                                <li><strong>İçerik planlaması ve niş seçimi</strong> ile ilgili danışabilirsiniz</li>
                            </ul>
                            <p>Lütfen tekrar sorunuzu sorar mısınız? Alternatif olarak, soldaki menüden bir konu seçebilirsiniz.</p>
                        `;
                        
                        // Yedek yanıtı ekle
                        addMessage('bot', fallbackResponse);
                    }
                } catch (error) {
                    console.error('API Hatası:', error);
                    
                    // Yükleniyor mesajını kaldır
                    chatContainer.removeChild(loadingMessage);
                    
                    // Hata mesajını göster
                    addMessage('bot', `
                        <p>Üzgünüm, bir teknik sorun oluştu. Bu genellikle aşağıdaki nedenlerden kaynaklanır:</p>
                        <ul>
                            <li>CORS politikası sorunları (tarayıcı kaynaklı)</li>
                            <li>API anahtarı limitleri veya kısıtlamaları</li>
                            <li>Geçici sunucu sorunları</li>
                        </ul>
                        <p>Lütfen tekrar deneyin veya soldaki menüden bir konu seçerek devam edin.</p>
                        <p><em>Teknik detay: ${error.message}</em></p>
                    `);
                }
            }

            // Yeni Sohbet Başlatma
            newChatBtn.addEventListener('click', function() {
                if (confirm('Yeni bir sohbet başlatmak istediğinize emin misiniz? Mevcut sohbet geçmişi silinecektir.')) {
                    chatContainer.innerHTML = '';
                    chatHistory = []; // Gemini bağlamını da temizle
                    localStorage.removeItem('yusufYamanChatHistory');
                    localStorage.removeItem('yusufYamanChatContext');
                    showWelcomeMessage();
                }
            });

            // Sohbet Geçmişi Öğesi Seçme
            historyItems.forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelector('.history-item.active').classList.remove('active');
                    this.classList.add('active');
                    
                    // Konu bazlı ekstra içerik gösterme
                    const topic = this.getAttribute('data-topic');
                    if (topic) {
                        chatContainer.innerHTML = '';
                        chatHistory = []; // Gemini bağlamını da temizle
                        
                        if (topic === 'welcome') {
                            showWelcomeMessage();
                        } else if (topic === 'instagram') {
                            addMessage('user', '<p>Instagram\'da keşfete nasıl çıkarım?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "Instagram'da keşfete nasıl çıkarım?" }]
                            });
                            generateBotResponse("Instagram'da keşfete nasıl çıkarım?");
                        } else if (topic === 'tiktok') {
                            addMessage('user', '<p>TikTok\'ta viral olmak için ne yapmalıyım?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "TikTok'ta viral olmak için ne yapmalıyım?" }]
                            });
                            generateBotResponse("TikTok'ta viral olmak için ne yapmalıyım?");
                        } else if (topic === 'dijitalurun') {
                            addMessage('user', '<p>Dijital ürün nasıl oluşturulur?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "Dijital ürün nasıl oluşturulur?" }]
                            });
                            generateBotResponse("Dijital ürün nasıl oluşturulur?");
                        } else if (topic === 'yapayzekaicin') {
                            addMessage('user', '<p>Yapay zeka ile içerik üretimi nasıl yapılır?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "Yapay zeka ile içerik üretimi nasıl yapılır?" }]
                            });
                            generateBotResponse("Yapay zeka ile içerik üretimi nasıl yapılır?");
                        } else if (topic === 'niskonulari') {
                            addMessage('user', '<p>Dijital ürün satışı için hangi nişi seçmeliyim?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "Dijital ürün satışı için hangi nişi seçmeliyim?" }]
                            });
                            generateBotResponse("Dijital ürün satışı için hangi nişi seçmeliyim?");
                        } else if (topic === 'monetizasyon') {
                            addMessage('user', '<p>Dijital içeriklerden nasıl para kazanabilirim?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "Dijital içeriklerden nasıl para kazanabilirim?" }]
                            });
                            generateBotResponse("Dijital içeriklerden nasıl para kazanabilirim?");
                        } else if (topic === 'contentplan') {
                            addMessage('user', '<p>Etkili bir içerik planı nasıl oluşturabilirim?</p>');
                            chatHistory.push({
                                role: "user",
                                parts: [{ text: "Etkili bir içerik planı nasıl oluşturabilirim?" }]
                            });
                            generateBotResponse("Etkili bir içerik planı nasıl oluşturabilirim?");
                        }
                    }
                });
            });

            // Enter Tuşu ile Gönderme
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Gönder Butonuna Tıklanınca
            sendButton.addEventListener('click', sendMessage);
            
            // Textarea Yükseklik Ayarlama
            userInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
                // Maksimum yükseklik
                if (this.scrollHeight > 150) {
                    this.style.height = '150px';
                    this.style.overflowY = 'auto';
                }
            });

            // Sayfa kapanmadan önce sohbeti kaydet
            window.onbeforeunload = function() {
                saveChatHistory();
            };
        });
    </script>
</body>
</html>
